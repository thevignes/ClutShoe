<!DOCTYPE html>
<html lang="en">
<head>
    <%-include('../../views/partial/user/header')%>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Address</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="/evara-frontend/assets/css/address.css">
</head>
<body>
    <div class="sidebar">
        <div class="profile">
            <img alt="Profile Picture" src="https://e7.pngegg.com/pngimages/136/22/png-clipart-user-profile-computer-icons-girl-customer-avatar-angle-heroes-thumbnail.png"/>
            <h2><%= user ? user.name : 'Guest' %></h2>
        </div>
        <ul class="menu">
            <li><a href="/profile"><i class="fas fa-user"></i> Account Overview</a></li>
            <li><a href="#"><i class="fas fa-box"></i> My Orders</a></li>
            <li><a class="active" href=""><i class="fas fa-address-book"></i> Manage Addresses</a></li>
            <li><a href="#"><i class="fas fa-wallet"></i> Wallet</a></li>
        </ul>
        <a class="logout" href="#">LOGOUT</a>
    </div>
    
    <div class="content">
        <div class="form-container">
            <div class="d-flex justify-content-between align-items-center text-right mb-3">
                <h3 class="mb-0">Add Address</h3>
                <button class="btn btn-primary">
                    <a href="/viewAddress" class="text-white text-decoration-none">View Address</a>
                </button>
            </div>
            
            <form action="/address/addAddress" method="POST" id="addressForm">
                <div class="form-group">
                    <input name="Firstname" id="Firstname" placeholder="First Name" type="text">
                    <small class="error-message text-danger" id="FirstnameError"></small>
                    <input name="Lastname" id="Lastname" placeholder="Last Name" type="text">
                    <small class="error-message text-danger" id="LastnameError"></small>
                </div>
                <div class="form-group">
                    <input name="place" id="place" placeholder="Place" type="text">
                    <small class="error-message text-danger" id="PlaceError"></small>
                    <input name="city" id="city" placeholder="City" type="text">
                    <small class="error-message text-danger" id="CityError"></small>
                </div>
                <div class="form-group">
                    <input name="district" id="district" placeholder="District" type="text">
                    <small class="error-message text-danger" id="DistrictError"></small>
                    <input name="state" id="state" placeholder="State" type="text">
                    <small class="error-message text-danger" id="StateError"></small>
                </div>
                <div class="form-group">
                    <input name="country" id="country" placeholder="Country" type="text">
                    <small class="error-message text-danger" id="CountryError"></small>
                    <input name="pin" id="pin" placeholder="Pin Code" type="number">
                    <small class="error-message text-danger" id="PinError"></small>
                </div>
                <div class="form-group">
                    <input name="type" id="type" placeholder="Type" type="text">
                    <small class="error-message text-danger" id="TypeError"></small>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel">Cancel</button>
                    <button type="button" class="save">Save</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.querySelector('.save').addEventListener('click', function(e) {
            e.preventDefault();
            let isValid = true;

            // Clear previous error messages
            document.querySelectorAll('.error-message').forEach(el => el.innerText = '');

            // Validation rules
            function validateField(field, minLength, maxLength, errorMessage) {
                const value = field.value.trim();
                const errorElement = document.getElementById(field.id + 'Error');
                
                if (value.length < minLength || value.length > maxLength) {
                    errorElement.innerText = errorMessage;
                    isValid = false;
                }
            }

            // Individual field validations
            validateField(document.getElementById('Firstname'), 2, 6, 'First Name must be 2-10 characters.');
            validateField(document.getElementById('Lastname'), 1, 3, 'Last Name must be 2-2 characters.');
            validateField(document.getElementById('place'), 2, 8, 'Place must be 2-10 characters.');
            validateField(document.getElementById('city'), 2, 8, 'City must be 2-6 characters.');
            validateField(document.getElementById('district'), 2, 8, 'District must be 2-8 characters.');
            validateField(document.getElementById('state'), 2, 8, 'State must be 2-5 characters.');
            validateField(document.getElementById('country'), 2, 8, 'Country must be 2-10 characters.');
            validateField(document.getElementById('pin'), 1, 6, 'Pin Code must be 5-6 digits.');

            // Check 'type' for specific values
            const typeField = document.getElementById('type');
            const typeError = document.getElementById('TypeError');
            if (!['Home', 'Office', 'Other'].includes(typeField.value.trim())) {
                typeError.innerText = 'Type must be "Home", "Office", or "Other".';
                isValid = false;
            }

            // Submit form if all fields are valid
            if (isValid) {
                document.getElementById('addressForm').submit();
            }
        });
    </script>

</body>
</html>
<%-include('../../views/partial/user/footer')%>
