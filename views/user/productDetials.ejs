<%-include('../../views/partial/user/header',{user})%>
    <!-- <link rel="stylesheet" href="/path/to/css/easyzoom.css" /> -->
    <!-- <link rel="stylesheet" href="/public/public/hover-extended-magnify/hover-extended-magnify/"> -->

    <main class="main">
        <div class="page-header breadcrumb-wrap">
            <div class="container">
                <div class="breadcrumb">
                    <a href="/" rel="nofollow">Home</a>
                    <span></span>shoes
                    <span></span>
                </div>
            </div>
        </div>
        <style>
            .custom-cart-button {
                width: 150px;
                /* Adjust width as desired */
                height: 40px;
                /* Adjust height as desired */
                font-size: 16px;
                /* Control font size */
                padding: 10px 20px;
                /* Adjust padding */
                background-color: #4CAF50;
                /* Add your preferred background color */
                color: #fff;
                /* Text color */
                border: none;
                border-radius: 5px;
                /* Rounded corners */
                cursor: pointer;
                transition: background-color 0.3s ease;
            }

            .zoom-container {
                overflow: hidden;
                /* Prevents the zoomed image from overflowing the container */
                position: relative;
                /* Required for positioning */
            }
            #wish{
                background-color: #45a049;
                border: none;
                padding: 5px;
                
            }

            #zoomable-image {
                transition: transform 0.2s ease;
                /* Smooth transition for zooming */
                display: block;
                /* Prevents gaps below the image */
            }

            .custom-cart-button:hover {
                background-color: #45a049;
                /* Slightly darker color on hover */
            }

            /* Add this to your CSS file */
            .quantity-input {
                width: 80px;
                /* Adjust the width as needed */
            }
            
            /* Product Details Styling */
            .detail-info {
                padding: 2rem;
                background: #fff;
                border-radius: 20px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.05);
                transition: all 0.3s ease;
            }
            
            .title-detail {
                font-size: 2.5rem;
                font-weight: 700;
                color: #2d3436;
                margin-bottom: 1.5rem;
                font-family: 'Segoe UI', sans-serif;
                line-height: 1.2;
            }
            
            /* Category and Rating */
            .product-detail-rating {
                background: #f8f9fa;
                padding: 1rem 1.5rem;
                border-radius: 15px;
                margin-bottom: 1.5rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            
            .pro-details-brand {
                background: #006A67;
                padding: 0.5rem 1.5rem;
                border-radius: 50px;
                transition: all 0.3s ease;
            }
            
            .pro-details-brand span, .pro-details-brand a {
                color: white;
                text-decoration: none;
                font-weight: 500;
            }
            
            .pro-details-brand:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0,106,103,0.2);
            }
            
            /* Price Styling */
            .product-price {
                display: flex;
                align-items: center;
                gap: 1rem;
                margin: 1.5rem 0;
            }
            
            .text-brand {
                font-size: 2rem;
                color: #006A67;
                font-weight: 700;
            }
            
            .old-price {
                text-decoration: line-through;
                color: #999;
                font-size: 1.2rem;
            }
            
            .save-price {
                background: linear-gradient(45deg, #006A67, #00857f);
                color: white;
                padding: 0.5rem 1.5rem;
                border-radius: 50px;
                font-weight: 500;
                animation: pulseSave 2s infinite;
            }
            
            @keyframes pulseSave {
                0% { transform: scale(1); }
                50% { transform: scale(1.05); }
                100% { transform: scale(1); }
            }
            
            /* Description */
            .short-desc {
                background: #f8f9fa;
                padding: 1.5rem;
                border-radius: 15px;
                margin: 1.5rem 0;
                transition: all 0.3s ease;
            }
            
            .short-desc:hover {
                transform: translateY(-2px);
                background: #f1f3f5;
            }
            
            /* Product Features */
            .product_sort_info ul {
                list-style: none;
                padding: 0;
            }
            
            .product_sort_info li {
                padding: 1rem 1.5rem;
                background: #f8f9fa;
                border-radius: 10px;
                margin-bottom: 0.8rem;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 1rem;
            }
            
            .product_sort_info li i {
                color: #006A67;
                font-size: 1.2rem;
            }
            
            .product_sort_info li:hover {
                transform: translateX(10px);
                background: #f1f3f5;
            }
            
            /* Stock Status */
            .product-meta {
                background: #f8f9fa;
                padding: 1rem 1.5rem;
                border-radius: 10px;
                margin-top: 1.5rem;
            }
            
            .in-stock {
                background: #00b894;
                color: white;
                padding: 0.3rem 1rem;
                border-radius: 50px;
                font-size: 0.9rem;
                font-weight: 500;
            }
            
            /* Buttons Container */
            .detail-extralink {
                display: flex;
                gap: 1rem;
                margin-top: 2rem;
            }
            
            /* Action Buttons */
            .action-btn {
                width: 45px;
                height: 45px;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                background: #f8f9fa;
                color: #006A67;
                transition: all 0.3s ease;
            }
            
            .action-btn:hover {
                background: #006A67;
                color: white;
                transform: rotate(360deg);
            }
            
            /* Responsive Design */
            @media (max-width: 768px) {
                .detail-info {
                    padding: 1rem;
                }
                
                .title-detail {
                    font-size: 1.8rem;
                }
                
                .product-price {
                    flex-direction: column;
                    align-items: flex-start;
                }
                
                .detail-extralink {
                    flex-direction: column;
                }
            }
            
/* Add to Cart Button */
#add {
    background: linear-gradient(45deg, #006A67, #00857f);
    color: white;
    border: none;
    padding: 1rem 2.5rem;
    border-radius: 50px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 5px 15px rgba(0,106,103,0.2);
}

#add:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 10px 25px rgba(0,106,103,0.3);
}

#add span {
    display: flex;
    align-items: center;
    gap: 8px;
}

#add i {
    transition: transform 0.3s ease;
}

#add:hover i {
    transform: translateX(5px);
}

/* Wishlist Button */
.wish {
    background: transparent;
    color: #006A67;
    border: 2px solid #006A67;
    padding: 1rem 2.5rem;
    border-radius: 50px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
    margin-top: 1rem;
}

.wish span {
    display: flex;
    align-items: center;
    gap: 8px;
    position: relative;
    z-index: 1;
}

.wish:before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, #006A67, #00857f);
    transition: all 0.5s ease;
    z-index: 0;
}

.wish:hover {
    color: white;
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(0,106,103,0.2);
}

.wish:hover:before {
    left: 0;
}

.wish i {
    transition: transform 0.3s ease;
}

.wish:hover i {
    transform: scale(1.2);
}

@keyframes heartBeat {
    0% { transform: scale(1); }
    50% { transform: scale(1.2); }
    100% { transform: scale(1); }
}

.wish.clicked i {
    animation: heartBeat 0.3s ease;
    color: #ff4757;
}

/* Action Buttons Container */
.action-buttons {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
}
.size-btn {
    min-width: 50px;
    height: 40px;
    border-radius: 8px;
    transition: all 0.3s ease;
}
.size-btn.selected {
    background-color: #212529;
    color: white;
}
</style>
          
        

        <section class="mt-50 mb-50">
            <div class="container">

                <div class="row flex-row-reverse">


                    <div class="col-lg-9 col-lg-3">
                        <div class="product-detail accordion-detail">
                            <div class="row mb-50">
                                <!-- Product Images Section -->
                                <div class="col-md-6 col-sm-12">
                                    <div class="detail-gallery">
                                        <!-- main Product Image -->
                                        <div class="zoom-container" onmousemove="zoomIn(event)"
                                            onmouseleave="resetZoom()">
                                            <img id="zoomable-image" alt="zoomable-image" class="rounded-lg"
                                                height="400" width="400"
                                                src="<%= ProductData.images && ProductData.images.length ? '/uploads/re-image/' + ProductData.images[0] : 'images/no_productImage.png' %>" />
                                        </div>
                                        <!-- Thumbnails -->
                                        <div class="slider-nav-thumbnails mt-3 d-flex">
                                            <% ProductData.images.forEach((image, index)=> { %>
                                                <img alt="Thumbnail <% index %>" class="thumbnail rounded-lg me-2"
                                                    height="150" width="130" src="/uploads/re-image/<%= image %>"
                                                    onclick="updateMainImage(this, '<%= image %>')" />
                                                <% }); %>
                                        </div>
                                        <!-- Social Share Icons -->
                                        <div class="social-icons single-share mt-3">
                                            <ul class="text-grey-5 d-inline-block">
                                                <li><strong class="me-2">Share this:</strong></li>
                                                <li class="social-facebook"><a href="#"><img
                                                            src="assets/imgs/theme/icons/icon-facebook.svg" alt=""></a>
                                                </li>
                                                <li class="social-twitter"><a href="#"><img
                                                            src="assets/imgs/theme/icons/icon-twitter.svg" alt=""></a>
                                                </li>
                                                <li class="social-instagram"><a href="#"><img
                                                            src="assets/imgs/theme/icons/icon-instagram.svg" alt=""></a>
                                                </li>
                                                <li class="social-linkedin"><a href="#"><img
                                                            src="assets/imgs/theme/icons/icon-pinterest.svg" alt=""></a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <!-- Product Details Section -->
                                <div class="col-md-6 col-sm-12">
                                    <div class="detail-info">
                                        <h2 class="title-detail">
                                            <%= ProductData.productName %>
                                        </h2>
                                        <div class="product-detail-rating">
                                            <div class="pro-details-brand">
                                                <span>Category: <a href="shop-grid-right.html">
                                                        <%= ProductData.category.name %>
                                                    </a></span>
                                            </div>
                                            <div class="product-rate-cover text-end">
                                                <div class="product-rate d-inline-block">
                                                    <div class="product-rating" style="width:90%"></div>
                                                </div>
                                                <span class="font-small ms-2 text-muted">(25 reviews)</span>
                                            </div>
                                        </div>
                                        <div class="clearfix product-price-cover">
                                            <div class="product-price primary-color float-left">
                                                <ins><span class="text-brand"><%= ProductData.salePrice %></span></ins>
                                                <ins><span class="old-price font-md ms-2"><%= ProductData.regularPrice
                                                            %></span></ins>
                                                            <% if (ProductData.offer) { %>
                                                                <span class="hot"  color: white; padding: 3px 5px; font-size: 12px;">
                                                                    <% if (ProductData.offer.type === 'percentage') { %>
                                                                        <span class="save-price font-md color3 ms-2"><%= ProductData.offer.value %>% OFF</span>
                                                                   
                                                                    <% } else if (ProductData.offer.type === 'flat') { %>
                                                                        <span class="save-price font-md color3 ms-2"> <%= ProductData.offer.value %> OFF</span>
                                                             
                                                                    <% } %>
                                                                </span>
                                                            <% } %>
                                            </div>
                                        </div>
                                        <div class="bt-1 border-color-1 mt-3 mb-3"></div>
                                        <div class="short-desc mb-3">
                                            <p>
                                                <%= ProductData.description %>
                                            </p>
                                        </div>
                            <h6 class="mb-2">Select Size:</h6>
                            <div class="d-flex flex-wrap gap-2 mb-3">
                                <input type="hidden" id="selectedSizeMain" name="selectedSize" value="">
                                <% if (ProductData.sizes && ProductData.sizes.length > 0) { %>
                                    <% ProductData.sizes.sort((a, b) => a.size - b.size).forEach(sizeData => { %>
                                        <button type="button" 
                                            class="btn btn-outline-dark size-btn me-2" 
                                            onclick="handleSizeSelect('<%= sizeData.size %>', <%= sizeData.quantity %>)"
                                            data-size="<%= sizeData.size %>"
                                            <%= sizeData.quantity === 0 ? 'disabled' : '' %>>
                                            <%= sizeData.size %>
                                        </button>
                                    <% }); %>
                                <% } else { %>
                                    <p class="text-muted">No sizes available</p>
                                <% } %>
                            </div>
                            
                            <!-- Add this div for quantity display -->
                            <div id="qtyInfo" class="alert alert-info" style="display: none;">
                                Size <span id="sizeValue"></span>: <span id="qtyValue"></span> pairs available
                            </div>
                                   
                                   <!-- Add this div for quantity display -->
                                   <div id="qtyInfo" class="alert alert-info" style="display: none;">
                                       Size <span id="sizeValue"></span>: <span id="qtyValue"></span> pairs available
                                   </div>
                                   <!-- Add quantity display section -->
                                   <div id="quantityInfo" class="mt-3" style="display: none;">
                                       <div class="d-flex align-items-center">
                                           <h6 class="mb-0 me-2">Available Quantity:</h6>
                                           <span id="availableQuantity" class="badge bg-primary"></span>
                                       </div>
                                       <!-- <div class="quantity-selector mt-2">
                                           <label for="quantity">Select Quantity:</label>
                                           <select id="quantity" name="quantity" class="form-select" style="width: 100px;">
                                           
                                           </select>
                                       </div> -->
                                   </div>

                                   <style>
                                       .size-btn-container {
                                           display: inline-flex;
                                           flex-direction: column;
                                           align-items: center;
                                           margin: 0.5rem;
                                       }
                                       .size-btn {
                                           min-width: 60px;
                                           position: relative;
                                           padding: 0.5rem 1rem;
                                       }
                                       .size-btn.disabled {
                                           opacity: 0.6;
                                           cursor: not-allowed;
                                       }
                                       .stock-badge {
                                           position: absolute;
                                           top: -8px;
                                           right: -8px;
                                           font-size: 0.7em;
                                           min-width: 20px;
                                           height: 20px;
                                           display: flex;
                                           align-items: center;
                                           justify-content: center;
                                       }
                                       .size-btn.active {
                                           background-color: #212529;
                                           color: white;
                                       }
                                       #quantityInfo {
                                           background-color: #f8f9fa;
                                           padding: 1rem;
                                           border-radius: 0.5rem;
                                           border: 1px solid #dee2e6;
                                       }
                                   </style>

                                   <script>
                                       function handleSizeSelect(size, quantity) {
                                    
                                           document.getElementById('selectedSizeMain').value = size;
                                         
                                           
                                       
                                           document.querySelectorAll('.size-btn').forEach(btn => {
                                               btn.classList.remove('active');
                                           });
                                           
                                       
                                           const selectedBtn = document.querySelector(`button[data-size="${size}"]`);
                                           if (selectedBtn) {
                                               selectedBtn.classList.add('active');
                                           }

                                           const quantityInfo = document.getElementById('quantityInfo');
                                           console.log(quantity)
                                           const availableQuantity = document.getElementById('availableQuantity');
                                           const quantitySelect = document.getElementById('quantity');
                                           
                                           if (quantity > 0) {
                                               quantityInfo.style.display = 'block';
                                               availableQuantity.textContent = quantity;

                                               quantitySelect.innerHTML = '';
                                               const maxAllowed = Math.min(quantity, 10);
                                               
                                               for (let i = 1; i <= maxAllowed; i++) {
                                                   const option = document.createElement('option');
                                                   option.value = i;
                                                   option.textContent = i;
                                                   quantitySelect.appendChild(option);
                                               }

                                               const qtyInfo = document.getElementById('qtyInfo');
                                               if (qtyInfo) {
                                                   document.getElementById('sizeValue').textContent = size;
                                                
                                                   document.getElementById('qtyValue').textContent = quantity;console.log('///',quantity)
                                                   console.log('info',qtyInfo)
                                                   qtyInfo.style.display = 'block';
                                               }
                                           }
                                       }
                                   </script>
                                   <input type="hidden" id="selectedSizeHidden" name="size">
                                        <% if (ProductData.quantity <=0) { %>
                                            <div class="alert alert-danger" role="alert">This product is currently out
                                                of stock.</div>
                                            <% } %>
                                                <div class="product_sort_info font-xs mb-3">
                                                    <ul>
                                                        <li class="mb-2"><i class="fi-rs-crown me-2"></i> 1 Year AL
                                                            Jazeera Brand Warranty</li>
                                                        <li class="mb-2"><i class="fi-rs-refresh me-2"></i> 30 Day
                                                            Return Policy</li>
                                                        <li><i class="fi-rs-credit-card me-2"></i> Cash on Delivery
                                                            available</li>
<div class="detail-extralink d-flex gap-2">
    <form class="add-to-cart">
        <button class="<%= ProductData.quantity !== 0 ? 'btn btn-sm px-3 py-1' : 'd-none' %>" type="button" id="add" onclick="addToCart('<%= ProductData._id %>')">
            <i class="fas fa-shopping-cart fa-sm"></i>
            Add to Cart
        </button>
    </form>
    <form id="wishlistForm" data-product-id="<%= ProductData._id %>">
        <button type="button" class="btn btn-sm btn-outline-secondary px-3 py-1" id="wish" onclick="addToWishlist('<%= ProductData._id %>')">
            <i class="fas fa-heart fa-sm"></i>
            Add to Wishlist
        </button>
    </form>
    
</div>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="tab-style3">
                            <ul class="nav nav-tabs text-uppercase">
                                <li class="nav-item">
                                    <a class="nav-link active" id="Description-tab" data-bs-toggle="tab"
                                        href="#Description">Description</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="Additional-info-tab" data-bs-toggle="tab"
                                        href="#Additional-info">Additional info</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="Reviews-tab" data-bs-toggle="tab" href="#Reviews">Reviews
                                        (3)</a>
                                </li>
                            </ul>
                            <div class="tab-content shop_info_tab entry-main-content">
                                <div class="tab-pane fade show active" id="Description">
                                    <div class="">
                                        <p>Uninhibited carnally hired played in whimpered dear gorilla
                                            koala
                                            depending and much yikes off far quetzal goodness and from
                                            for
                                            grimaced goodness unaccountably and meadowlark near
                                            unblushingly
                                            crucial scallop
                                            tightly neurotic hungrily some and dear furiously this
                                            apart.</p>
                                        <p>Spluttered narrowly yikes left moth in yikes bowed this that
                                            grizzly
                                            much hello on spoon-fed that alas rethought much decently
                                            richly and
                                            wow against the frequent fluidly at formidable acceptably
                                            flapped
                                            besides and much circa far over the bucolically hey
                                            precarious
                                            goldfinch mastodon goodness gnashed a jellyfish and one
                                            however
                                            because.
                                        </p>
                                        <ul class="product-more-infor mt-30">
                                            <li><span>Type Of Packing</span> Bottle</li>
                                            <li><span>Color</span> Green, Pink, Powder Blue, Purple</li>
                                            <li><span>Quantity Per Case</span> 100ml</li>
                                            <li><span>Ethyl Alcohol</span> 70%</li>
                                            <li><span>Piece In One</span> Carton</li>
                                        </ul>
                                        <hr class="wp-block-separator is-style-dots">
                                        <p>Laconic overheard dear woodchuck wow this outrageously taut
                                            beaver
                                            hey hello far meadowlark imitatively egregiously hugged that
                                            yikes
                                            minimally unanimous pouted flirtatiously as beaver beheld
                                            above
                                            forward
                                            energetic across this jeepers beneficently cockily less a
                                            the
                                            raucously that magic upheld far so the this where crud then
                                            below
                                            after jeez enchanting drunkenly more much wow callously
                                            irrespective
                                            limpet.</p>
                                        <h4 class="mt-30">Packaging & Delivery</h4>
                                        <hr class="wp-block-separator is-style-wide">
                                        <p>Less lion goodness that euphemistically robin expeditiously
                                            bluebird
                                            smugly scratched far while thus cackled sheepishly rigid
                                            after due
                                            one assenting regarding censorious while occasional or this
                                            more
                                            crane
                                            went more as this less much amid overhung anathematic
                                            because much
                                            held one exuberantly sheep goodness so where rat wry well
                                            concomitantly.
                                        </p>
                                        <p>Scallop or far crud plain remarkably far by thus far iguana
                                            lewd
                                            precociously and and less rattlesnake contrary caustic wow
                                            this near
                                            alas and next and pled the yikes articulate about as less
                                            cackled
                                            dalmatian
                                            in much less well jeering for the thanks blindly sentimental
                                            whimpered less across objectively fanciful grimaced wildly
                                            some wow
                                            and rose jeepers outgrew lugubrious luridly irrationally
                                            attractively
                                            dachshund.
                                        </p>
                                    </div>
                                </div>


                                <div class="tab-pane fade" id="Reviews">
                                    <!--Comments-->
                                    <div class="comments-area">
                                        <div class="row">
                                            <div class="col-lg-8">
                                                <h4 class="mb-30">Customer questions & answers</h4>
                                                <div class="comment-list">
                                                    <div class="single-comment justify-content-between d-flex">
                                                        <div class="user justify-content-between d-flex">
                                                            <div class="thumb text-center">
                                                                <img src="assets/imgs/page/avatar-6.jpg" alt="">
                                                                <h6><a href="#">Jacky Chan</a></h6>
                                                                <p class="font-xxs">Since 2012</p>
                                                            </div>
                                                            <div class="desc">
                                                                <div class="product-rate d-inline-block">
                                                                    <div class="product-rating" style="width:90%">
                                                                    </div>
                                                                </div>
                                                                <p>Thank you very fast shipping from
                                                                    Poland only
                                                                    3days.</p>
                                                                <div class="d-flex justify-content-between">
                                                                    <div class="d-flex align-items-center">
                                                                        <p class="font-xs mr-30">
                                                                            December 4,
                                                                            2020 at 3:12 pm </p>
                                                                        <a href="#" class="text-brand btn-reply">Reply
                                                                            <i class="fi-rs-arrow-right"></i>
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!--single-comment -->
                                                    <div class="single-comment justify-content-between d-flex">
                                                        <div class="user justify-content-between d-flex">
                                                            <div class="thumb text-center">
                                                                <img src="assets/imgs/page/avatar-7.jpg" alt="">
                                                                <h6><a href="#">Ana Rosie</a></h6>
                                                                <p class="font-xxs">Since 2008</p>
                                                            </div>
                                                            <div class="desc">
                                                                <div class="product-rate d-inline-block">
                                                                    <div class="product-rating" style="width:90%">
                                                                    </div>
                                                                </div>
                                                                <p>Great low price and works well.</p>
                                                                <div class="d-flex justify-content-between">
                                                                    <div class="d-flex align-items-center">
                                                                        <p class="font-xs mr-30">
                                                                            December 4,
                                                                            2020 at 3:12 pm </p>
                                                                        <a href="#" class="text-brand btn-reply">Reply
                                                                            <i class="fi-rs-arrow-right"></i>
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!--single-comment -->
                                                    <div class="single-comment justify-content-between d-flex">
                                                        <div class="user justify-content-between d-flex">
                                                            <div class="thumb text-center">
                                                                <img src="assets/imgs/page/avatar-8.jpg" alt="">
                                                                <h6><a href="#">Steven Keny</a></h6>
                                                                <p class="font-xxs">Since 2010</p>
                                                            </div>
                                                            <div class="desc">
                                                                <div class="product-rate d-inline-block">
                                                                    <div class="product-rating" style="width:90%">
                                                                    </div>
                                                                </div>
                                                                <p>Authentic and Beautiful, Love these
                                                                    way more
                                                                    than ever expected They are Great
                                                                    earphones
                                                                </p>
                                                                <div class="d-flex justify-content-between">
                                                                    <div class="d-flex align-items-center">
                                                                        <p class="font-xs mr-30">
                                                                            December 4,
                                                                            2020 at 3:12 pm </p>
                                                                        <a href="#" class="text-brand btn-reply">Reply
                                                                            <i class="fi-rs-arrow-right"></i>
                                                                        </a>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!--single-comment -->
                                                </div>
                                            </div>
                                            <div class="col-lg-4">

                                            </div>
                                        </div>
                                        <!--comment form-->
                                        <div class="comment-form">
                                            <h4 class="mb-15">Add a review</h4>
                                            <div class="product-rate d-inline-block mb-30">
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-8 col-md-12">


                                                    <!-- <form class="form-contact comment_form" 
                                                                id="commentForm">
                                                                <div class="row">
                                                                    <div class="col-12">
                                                                        <div class="form-group">
                                                                            <textarea class="form-control w-100"
                                                                                name="comment" id="comment" cols="30"
                                                                                rows="9"
                                                                                placeholder="Write Comment"></textarea>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-sm-6">
                                                                        <div class="form-group">
                                                                            <input class="form-control" name="name"
                                                                                id="name" type="text"
                                                                                placeholder="Name">
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-sm-6">
                                                                        <div class="form-group">
                                                                            <input class="form-control" name="email"
                                                                                id="email" type="email"
                                                                                placeholder="Email">
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-12">
                                                                        <div class="form-group">
                                                                            <input class="form-control" name="website"
                                                                                id="website" type="text"
                                                                                placeholder="Website">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <button type="submit"
                                                                        class="button button-contactForm">Submit
                                                                        Review</button>
                                                                </div>
                                                            </form> -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>




                <div class="col-12">
                    <h3 class="section-title style-1 mb-30">Related products</h3>
                </div>
                <div class="row related-products">
                    <% relatedProducts.forEach(product=> { %>
                        <div class="col-lg-3 col-md-4 col-12 col-sm-6">
                            <div class="product-cart-wrap small hover-up">
                                <div class="product-img-action-wrap">
                                    <div class="product-img product-img-zoom">
                                        <a href="/products/<%= product._id %>" tabindex="0">
                                            <img class="default-img" src="/uploads/re-image/<%= product.images[0] %>"
                                                alt="">

                                            <img class="hover-img"
                                                src="/uploads/re-image/products.images[1] %>" alt="">


                                        </a>
                                    </div>
                                

                                </div>
                                <div class="product-content-wrap">
                                    <h2><a href="/products/<%= product._id %>" tabindex="0">
                                            <%= product.productName %>
                                        </a></h2>
                                    <div class="rating-result" title="<%= product.rating * 20 %>%">

                                    </div>
                                    <div class="product-price">
                                        <span>$<%= product.salePrice %> </span>

                                        <span class="old-price">$<%= product.regularPrice %></span>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <% }) %>
                </div>

        </section>
    </main>

    <script>
        function updateQuantity(selectElement, productId) {
            const newQuantity = selectElement.value;

            // Make a POST request to update the quantity in the cart
            fetch('/cart/update-quantity', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ productId, quantity: newQuantity }),
                credentials: 'include'
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Update the cart UI, reload the page, or notify the user
                        location.reload(); // Simple way to reflect changes
                    } else {
                        alert(data.message); // Show an error message
                    }
                })
                .catch(error => {
                    console.error('Error updating quantity:', error);
                    alert('Something went wrong. Please try again.');
                });
        }

    </script>






    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/zoom/extm.min.js"></script>

    


    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        function addToWishlist(productId) {
            fetch('/wishlist/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ productId })
            })
            .then(response => response.json())
            .then(data => {
                if (data.message === 'User not logged in') {
                    Swal.fire({
                        icon: 'warning',
                        title: 'Please login first',
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 2000,
                        timerProgressBar: true,
                        background: 'white',
                        iconColor: 'orange',
                    });
                    setTimeout(() => {
                        window.location.href = '/login';
                    }, 2000);
                } else {
                    Swal.fire({
                        icon: 'success',
                        title: data.message,
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        background: 'white', 
                        iconColor: 'green',
                    });
                }
            })
            .catch(error => {
                console.error('Error:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Failed to add to wishlist',
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    background: 'white',
                    iconColor: 'red',
                });
            });
        }
    </script>
    

    <script>
        async function addToCart(productId) {
            try {
                // Get the selected size from the hidden input
                const selectedSize = document.getElementById('selectedSizeMain').value;
                console.log('Selected size:', selectedSize);   
                
                if (!selectedSize) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'Please select a size first',
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        background: 'white',
                        iconColor: 'orange',
                    });
                    return;
                }

                const response = await fetch(`/add-to-cart?id=${productId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ size: selectedSize }),
                    credentials: 'include'
                });

                console.log('response', response)

                const data = await response.json();

                console.log('data', data)

                if (!response.ok) {
                    if (data.message === 'please login first' || response.status === 401) {
                        Swal.fire({
                            icon: 'warning',
                            title: 'Please login first',
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 2000,
                            timerProgressBar: true,
                            background: 'white',
                            iconColor: 'orange',
                        });
                        setTimeout(() => {
                            window.location.href = '/login';
                        }, 2000);
                        return;
                    }
                    throw new Error(data.message || 'Failed to add to cart');
                }

                // Success case
                Swal.fire({
                    icon: 'success',
                    title: data.message || 'Added to cart successfully',
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    background: 'white',
                    iconColor: 'green',
                });

            } catch (error) {
                console.error("Error adding to cart:", error);
                Swal.fire({
                    icon: 'error',
                    title: error.message || 'Something went wrong. Please try again.',
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    background: 'white',
                    iconColor: 'red'
                });
            }
        }
    </script>

    </script>
    <script>
        function updateMainImage(selectedThumbnail, imageSrc) {
            document.getElementById('zoomable-image').src = '/uploads/re-image/' + imageSrc;

            document.querySelectorAll('.thumbnail').forEach(thumbnail => {
                thumbnail.classList.remove('active');
            });
            selectedThumbnail.classList.add('active');
        }
        document.addEventListener("DOMContentLoaded", function () {
            const firstThumbnail = document.querySelector('.thumbnail');
            if (firstThumbnail) {
                firstThumbnail.classList.add('active');
            }
        });
        const zoomFactor = 2.5;

        function zoomIn(event) {
            const zoomableImage = document.getElementById('zoomable-image');

            // Get the bounding rectangle of the image
            const rect = zoomableImage.getBoundingClientRect();

            // Calculate the mouse position relative to the image
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;

            // Calculate the transform origin to keep the zoom centered on the cursor
            const originX = (x / rect.width) * 100;
            const originY = (y / rect.height) * 100;

            // Apply transform with scale and origin
            zoomableImage.style.transformOrigin = `${originX}% ${originY}%`;
            zoomableImage.style.transform = `scale(${zoomFactor})`;
        }

        function resetZoom() {
            const zoomableImage = document.getElementById('zoomable-image');
            zoomableImage.style.transform = 'scale(1)';
        }
    </script>
<script>
document.getElementById('wish').addEventListener('click', function() {
    this.classList.add('clicked');
    setTimeout(() => this.classList.remove('clicked'), 300);
});

function showQuantity(size, qty) {
    document.getElementById('selectedSizeMain').value = size;
    document.getElementById('selectedSizeHidden').value = size;
    document.getElementById('sizeValue').textContent = size;
    document.getElementById('qtyValue').textContent = qty;
    document.getElementById('qtyInfo').style.display = 'block';
}
function selectSize(button, size, maxQuantity) {
    // Remove selected class from all buttons
    document.querySelectorAll('.size-btn').forEach(btn => {
        btn.classList.remove('selected');
    });
    
    // Add selected class to clicked button
    button.classList.add('selected');
    
    // Store selected size
    document.getElementById('selectedSizeMain').value = size;
    
    // Hide error message if shown
    document.getElementById('sizeError').classList.add('d-none');
}
</script>


    <%-include('../../views/partial/user/footer')%>